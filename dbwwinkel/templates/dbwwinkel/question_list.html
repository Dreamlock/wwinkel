{% extends 'base/base.html' %}
{% load static %}
{% load index %}

{% block extra_head %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="{% static "dbwwinkel/js/myjs.js" %}"></script>
    <script src="{% static "dbwwinkel/js/facet.js" %}"></script>

    <style>
        /* Center the loader */
        #loader {
            position: absolute;
            left: 50%;
            top: 50%;
            z-index: 1;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #3498db;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        /* Add animation to "page content" */
        .animate-bottom {
            position: relative;
            -webkit-animation-name: animatebottom;
            -webkit-animation-duration: 1s;
            animation-name: animatebottom;
            animation-duration: 1s
        }

        @-webkit-keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }
            to {
                bottom: 0px;
                opacity: 1
            }
        }

        @keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }
            to {
                bottom: 0;
                opacity: 1
            }
        }

        #myDiv {
            display: none;
            text-align: center;
        }
    </style>

{% endblock %}
{% block body_loader %}
    <body onload="myFunction()" style="margin:0;">
{% endblock %}
{% block content %}

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3 col-lg-2">
                <div class="sidebar-nav-fixed affix">
                    <div class="well">
                        <ul class="nav ">
                            <form name="form" action="{% url "list_questions" %}" method='GET' accept-charset="utf-8"
                                  id="form">
                                <strong>Gezocht op: {{ search_text }}</strong>
                                <input type="hidden" name="search_text" value="{{ search_text }}">
                                {% if user_type == 'student' %}
                                    {% include 'dbwwinkel/Options_question_list/options_students.html' %}
                                {% elif user_type == 'manager_user' %}
                                    {% include 'dbwwinkel/Options_question_list/options_admin.html' %}
                                {% endif %}
                            </form>
                        </ul>
                    </div>
                    <!--/.well -->
                </div>
                <!--/sidebar-nav-fixed -->
            </div>
            <!--/span-->
            <div id='loader'></div>
            <div style="display:none;" id="myDiv">
                    <div class="col-md-9 col-lg-10">
                        <table class="table table-striped table-hover">
                            <thead>
                            <tr>
                                <th class ='text-center'>Publicatie datum</th>
                                <th class ='text-center'>Organisatie</th>
                                <th class ='text-center'>Vraag</th>
                                <th class ='text-center'>Deadline</th>
                                <th class ='text-center'>Status</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for question in questions %}
                                {# if user.has_perm('view_question', question) Todo: let the permissions work#}
                                {#forloop.counter0 #Todo: limit to first 30 questions (then question 31-60, 61-90,...) #}
                                <tr data-href="{% url 'detail_question' question.object.id %}"
                                    class='table-row'
                                    style="cursor:pointer;">
                                    <td class = 'col-md-2'>{{ question.object.creation_date.date }}</td>
                                    <td class = 'col-md-2'>{{ question.object.organisation_name }}</td>
                                    <td class = 'col-md-4'>{{ question.object.question_text }}</td>
                                    <td class = 'col-md-2'>{{ question.object.deadline }}</td>
                                    <td class = 'col-md-2'>{{ question.object.get_state_display }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
        </div>
    </div>
{% endblock %}
{% block extra_scripts %}
    <script>
        var myVar;

        function myFunction() {
            myVar = setTimeout(showPage, 1000);
        }

        function showPage() {
            document.getElementById("loader").style.display = "none";
            document.getElementById("myDiv").style.display = "block";
        }
    </script>
{% endblock %}